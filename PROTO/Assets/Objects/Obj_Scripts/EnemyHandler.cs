using System.Collections;
using System.Collections.Generic;
using UnityEngine;

using static Utilities.Generic;

public class EnemyHandler : MonoBehaviour
{
    // Object State Variables:
    public GameObject damaged_Particle;
    public AudioSource damaged_Sound;
    public AudioSource death_Sound;

    private Obj_State obj_Data;
    private Rigidbody2D obj_Physics;

    // Initiate State:
    void Start()
    {
        obj_Data = GetComponent<Obj_State>();
        obj_Physics = GetComponent<Rigidbody2D>();
    }

    // Health System
    void Update()
    {
        if (obj_Data.Health == 0)
            Destroy(gameObject);

        obj_Physics.AddRelativeForce(Vector2.right * obj_Data.Speed);
    }
    void OnCollisionEnter2D(Collision2D sender)
    {
        if (sender.gameObject.layer == LayerMask.NameToLayer("Projectile"))
        {
            Obj_State projectile_Data = sender.gameObject.GetComponent<Obj_State>();
            damaged_Particle.GetComponent<ParticleSystem>().Play();
            damaged_Sound.Play();
            obj_Data.Health = Mathf.Max(obj_Data.Health - projectile_Data.Damage, 0);
            Destroy(sender.gameObject);
        }
    }
    void OnDestroy()
    {
        death_Sound.Play();
    }
}